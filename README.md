# Azusa Radar â€” æŠ•è³‡é›·é”

ç³»çµ±åŒ–è¿½è¹¤è‚¡ç¥¨ã€ç®¡ç†è§€é»æ¼”é€²ã€ä¸¦é€éä¸‰å±¤æ¼æ–—è‡ªå‹•æƒææŠ€è¡“é¢èˆ‡åŸºæœ¬é¢ç•°å¸¸ã€‚

## åŠŸèƒ½ç‰¹è‰²

- **å››å¤§åˆ†é¡è¿½è¹¤** â€” é¢¨å‘çƒ / è­·åŸæ²³ / æˆé•·å¤¢æƒ³ / ETFï¼Œå„é¡æœ‰å°ˆå±¬åˆ†é 
- **è§€é»ç‰ˆæ§ (Thesis Versioning)** â€” æ¯æ¬¡æ›´æ–°è§€é»è‡ªå‹•éå¢ç‰ˆè™Ÿï¼Œå®Œæ•´ä¿ç•™æ­·å²æ¼”é€²
- **å‹•æ…‹æ¨™ç±¤ (Dynamic Tagging)** â€” ç‚ºè‚¡ç¥¨æ¨™è¨˜é ˜åŸŸæ¨™ç±¤ï¼ˆAIã€Cloudã€SaaS...ï¼‰ï¼Œæ¨™ç±¤éš¨è§€é»ç‰ˆæ§ä¸€ä½µå¿«ç…§
- **V2 ä¸‰å±¤æ¼æ–—æƒæ** â€” å¸‚å ´æƒ…ç·’ â†’ è­·åŸæ²³è¶¨å‹¢ â†’ æŠ€è¡“é¢è¨Šè™Ÿ â†’ è‡ªå‹•ç”¢ç”Ÿæ±ºç­–ç‡ˆè™Ÿï¼ˆä¸¦è¡Œæƒæ 4 è‚¡åŒæ™‚ï¼‰
- **è­·åŸæ²³å¥æª¢** â€” æ¯›åˆ©ç‡ 5 å­£èµ°å‹¢åœ– + YoY äº”ç´šè¨ºæ–·ï¼ˆè­·åŸæ²³ç©©å›º / éŒ¯æ®ºæ©Ÿæœƒ / è‚¡åƒ¹åå¼± / Thesis Broken / è§€å¯Ÿä¸­ï¼‰
- **æƒææ­·å²** â€” æŒä¹…åŒ–æ¯æ¬¡æƒæçµæœï¼Œå¯æŸ¥çœ‹å€‹è‚¡æƒææ™‚é–“è»¸èˆ‡é€£çºŒç•°å¸¸æ¬¡æ•¸
- **è‡ªè¨‚åƒ¹æ ¼è­¦å ±** â€” ç‚ºå€‹è‚¡è¨­å®š RSI / åƒ¹æ ¼ / ä¹–é›¢ç‡é–€æª»ï¼Œè§¸ç™¼æ™‚é€é Telegram å³æ™‚é€šçŸ¥ï¼ˆ4 å°æ™‚å†·å»ï¼‰
- **è²¡å ±æ—¥æ›†** â€” è‡ªå‹•é¡¯ç¤ºä¸‹æ¬¡è²¡å ±æ—¥æœŸï¼Œ14 å¤©å…§å€’æ•¸æé†’
- **è‚¡æ¯è³‡è¨Š** â€” è­·åŸæ²³èˆ‡ ETF é¡è‚¡ç¥¨é¡¯ç¤ºæ®–åˆ©ç‡èˆ‡é™¤æ¯æ—¥
- **æ‹–æ›³æ’åº** â€” é€é drag-and-drop èª¿æ•´è‚¡ç¥¨é¡¯ç¤ºé †ä½ï¼Œé †ä½å¯«å…¥è³‡æ–™åº«æŒä¹…åŒ–
- **ç§»é™¤èˆ‡å°å­˜** â€” ç§»é™¤è‚¡ç¥¨æ™‚è¨˜éŒ„åŸå› ï¼Œå°å­˜è‡³ã€Œå·²ç§»é™¤ã€åˆ†é ï¼Œæ”¯æ´é‡æ–°å•Ÿç”¨
- **åŒ¯å‡º / åŒ¯å…¥** â€” JSON æ ¼å¼åŒ¯å‡ºè§€å¯Ÿåå–®ï¼Œæ”¯æ´ Dashboard ä¸Šå‚³åŒ¯å…¥æˆ– CLI è…³æœ¬åŒ¯å…¥ï¼ˆupsertï¼‰
- **å®šæ™‚æƒæ** â€” æ¯ 30 åˆ†é˜è‡ªå‹•åŸ·è¡Œä¸‰å±¤æ¼æ–—æƒæï¼ˆéåŒæ­¥ï¼‰ï¼Œåƒ…æ¨æ’­ã€Œå·®ç•°ã€é€šçŸ¥ï¼ˆè¨Šè™Ÿè®ŠåŒ–æ™‚æ‰ç™¼é€ï¼‰
- **æ¯é€±æ‘˜è¦** â€” æ¯é€±æ—¥è‡ªå‹•ç™¼é€ Telegram æŠ•è³‡çµ„åˆå¥åº·å ±å‘Šï¼ˆå¥åº·åˆ†æ•¸ + ç•°å¸¸è‚¡ç¥¨ + æœ¬é€±è¨Šè™Ÿè®ŠåŒ–ï¼‰
- **yfinance é€Ÿç‡é™åˆ¶** â€” å…§å»º Rate Limiterï¼ˆ2 æ¬¡/ç§’ï¼‰ï¼Œé¿å…è¢« Yahoo Finance å°é–
- **å…§å»º SOP æŒ‡å¼•** â€” Dashboard å…§é™„æ“ä½œèªªæ˜æ›¸

## æ ¸å¿ƒé‚è¼¯

### åˆ†é¡èˆ‡æƒæè¦å‰‡

| åˆ†é¡ | èªªæ˜ | Layer 1 åƒèˆ‡ |
|------|------|:------------:|
| **é¢¨å‘çƒ (Trend Setter)** | å¤§ç›¤ ETFã€å·¨é ­ï¼Œè§€å¯Ÿè³‡é‡‘æµå‘èˆ‡ Capex | æ˜¯ |
| **è­·åŸæ²³ (Moat)** | ä¾›æ‡‰éˆä¸­ä¸å¯æ›¿ä»£çš„è³£éŸå­å…¬å¸ | å¦ |
| **æˆé•·å¤¢æƒ³ (Growth)** | é«˜æ³¢å‹•ã€å…·æƒ³åƒç©ºé–“çš„æˆé•·è‚¡ | å¦ |
| **ETF** | æŒ‡æ•¸å‹åŸºé‡‘ï¼Œè¢«å‹•è¿½è¹¤å¸‚å ´æˆ–ä¸»é¡Œ | å¦ |

### V2 ä¸‰å±¤æ¼æ–—

```mermaid
flowchart TD
    L1["Layer 1: å¸‚å ´æƒ…ç·’"] -->|"é¢¨å‘çƒè·Œç ´ 60MA æ¯”ä¾‹"| Decision{">50%?"}
    Decision -->|"æ˜¯"| CAUTION["CAUTION é›¨å¤©"]
    Decision -->|"å¦"| POSITIVE["POSITIVE æ™´å¤©"]

    L2["Layer 2: è­·åŸæ²³è¶¨å‹¢"] -->|"æ¯›åˆ©ç‡ YoY"| MoatCheck{"è¡°é€€ >2pp?"}
    MoatCheck -->|"æ˜¯"| BROKEN["THESIS_BROKEN"]
    MoatCheck -->|"å¦"| L3

    L3["Layer 3: æŠ€è¡“é¢"] -->|"RSI, Bias, Volume Ratio"| TechCheck
    TechCheck -->|"RSI<35 + å¸‚å ´æ­£é¢"| BUY["CONTRARIAN_BUY"]
    TechCheck -->|"Bias>20%"| HOT["OVERHEATED"]
    TechCheck -->|"å…¶ä»–"| NORMAL["NORMAL"]
```

## æŠ€è¡“æ¶æ§‹

```mermaid
graph LR
  subgraph docker [Docker Compose]
    FE["Streamlit Frontend :8501"]
    BE["FastAPI Backend :8000"]
    DB[("SQLite radar.db")]
  end
  YF["yfinance API"]
  TG["Telegram Bot API"]
  FE -->|"HTTP requests"| BE
  BE -->|"read/write"| DB
  BE -->|"fetch market data"| YF
  BE -->|"send alerts"| TG
```

- **Backend** â€” FastAPI + SQLModelï¼Œè² è²¬ APIã€è³‡æ–™åº«ã€æƒæé‚è¼¯
- **Frontend** â€” Streamlit Dashboardï¼Œåˆ†é é¡¯ç¤ºå››é¡è‚¡ç¥¨ï¼ˆ+ å·²ç§»é™¤å°å­˜ï¼‰èˆ‡è§€é»ç·¨è¼¯
- **Database** â€” SQLiteï¼Œé€é Docker Volume æŒä¹…åŒ–ï¼ˆå« ScanLogã€PriceAlert è³‡æ–™è¡¨ï¼‰
- **è³‡æ–™ä¾†æº** â€” yfinanceï¼ˆä½¿ç”¨ curl_cffi ç¹é bot é˜²è­·ï¼‰ï¼Œå« `cachetools` è¨˜æ†¶é«”å¿«å– + Rate Limiterï¼ˆ2 æ¬¡/ç§’ï¼‰
- **é€šçŸ¥** â€” Telegram Bot APIï¼ˆå·®ç•°é€šçŸ¥ + åƒ¹æ ¼è­¦å ± + æ¯é€±æ‘˜è¦ï¼‰
- **ä¸¦è¡Œæƒæ** â€” `ThreadPoolExecutor(max_workers=4)` åŠ é€Ÿæƒæï¼Œå— Rate Limiter ä¿è­·
- **æ‹–æ›³æ’åº** â€” `streamlit-sortables` å…ƒä»¶

## å¿«é€Ÿé–‹å§‹

### å‰ç½®éœ€æ±‚

- [Docker Desktop](https://www.docker.com/products/docker-desktop/) å·²å®‰è£ä¸¦å•Ÿå‹•
- Python 3ï¼ˆåƒ…é™æœ¬æ©ŸåŸ·è¡ŒåŒ¯å…¥è…³æœ¬æ™‚éœ€è¦ï¼‰

### 1. è¨­å®šç’°å¢ƒè®Šæ•¸

ç·¨è¼¯å°ˆæ¡ˆæ ¹ç›®éŒ„çš„ `.env` æª”æ¡ˆï¼Œå¡«å…¥ Telegram Bot æ†‘è­‰ï¼š

```env
TELEGRAM_BOT_TOKEN=your-telegram-bot-token-here
TELEGRAM_CHAT_ID=your-telegram-chat-id-here
```

> è‹¥ä¸éœ€è¦ Telegram é€šçŸ¥ï¼Œä¿ç•™é è¨­å€¼å³å¯ï¼Œç³»çµ±æœƒè‡ªå‹•è·³éç™¼é€ã€‚

### 2. å•Ÿå‹•æœå‹™

```bash
docker compose up --build
```

- **Backend API** â€” http://localhost:8000ï¼ˆSwagger æ–‡ä»¶ï¼šhttp://localhost:8000/docsï¼‰
- **Frontend Dashboard** â€” http://localhost:8501
- **Scanner** â€” Alpine cron å®¹å™¨ï¼Œæ¯ 30 åˆ†é˜è‡ªå‹•æƒæï¼ˆ`POST /scan`ï¼‰ï¼Œæ¯é€±æ—¥ 18:00 UTC ç™¼é€é€±å ±ï¼ˆ`POST /digest`ï¼‰

### 3. åŒ¯å…¥è§€å¯Ÿåå–®

**æ–¹å¼ä¸€ï¼šDashboard UI ä¸Šå‚³**

åœ¨å·¦å´é¢æ¿ã€ŒğŸ“¤ åŒ¯å…¥è§€å¯Ÿåå–®ã€å€å¡Šä¸Šå‚³ JSON æª”æ¡ˆï¼Œé»æ“Šç¢ºèªå³å¯åŒ¯å…¥ã€‚

**æ–¹å¼äºŒï¼šCLI è…³æœ¬**

```bash
# å»ºç«‹è™›æ“¬ç’°å¢ƒï¼ˆé¦–æ¬¡ï¼‰
python3 -m venv .venv
source .venv/bin/activate
pip install requests

# åŒ¯å…¥é è¨­è§€å¯Ÿåå–®
python scripts/import_stocks.py

# æˆ–æŒ‡å®šè‡ªè¨‚ JSON æª”æ¡ˆ
python scripts/import_stocks.py path/to/custom_list.json
```

> å…©ç¨®æ–¹å¼çš†æ”¯æ´ upsertï¼šè‹¥è‚¡ç¥¨å·²å­˜åœ¨ï¼Œæœƒè‡ªå‹•æ›´æ–°è§€é»èˆ‡æ¨™ç±¤ï¼ˆç‰ˆæ§éå¢ï¼‰ã€‚

### 4. é‡ç½®è³‡æ–™åº«

```bash
docker compose down -v
docker compose up --build
```

`-v` æœƒç§»é™¤ Docker Volumeï¼ˆå« `radar.db`ï¼‰ï¼Œé‡å•Ÿå¾Œè‡ªå‹•å»ºç«‹ç©ºç™½è³‡æ–™åº«ã€‚

## API åƒè€ƒ

| Method | Path | èªªæ˜ |
|--------|------|------|
| `GET` | `/health` | Health checkï¼ˆDocker å¥åº·æª¢æŸ¥ç”¨ï¼‰ |
| `POST` | `/ticker` | æ–°å¢è¿½è¹¤è‚¡ç¥¨ï¼ˆå«åˆå§‹è§€é»èˆ‡æ¨™ç±¤ï¼‰ |
| `GET` | `/stocks` | å–å¾—æ‰€æœ‰è¿½è¹¤è‚¡ç¥¨ï¼ˆåƒ… DB è³‡æ–™ï¼‰ |
| `PUT` | `/stocks/reorder` | æ‰¹æ¬¡æ›´æ–°è‚¡ç¥¨é¡¯ç¤ºé †ä½ |
| `GET` | `/stocks/export` | åŒ¯å‡ºæ‰€æœ‰è‚¡ç¥¨ï¼ˆJSON æ ¼å¼ï¼Œå«è§€é»èˆ‡æ¨™ç±¤ï¼‰ |
| `POST` | `/stocks/import` | æ‰¹æ¬¡åŒ¯å…¥è‚¡ç¥¨ï¼ˆJSON bodyï¼Œupsert é‚è¼¯ï¼‰ |
| `GET` | `/stocks/removed` | å–å¾—æ‰€æœ‰å·²ç§»é™¤è‚¡ç¥¨ |
| `GET` | `/ticker/{ticker}/signals` | å–å¾—å–®ä¸€è‚¡ç¥¨çš„æŠ€è¡“è¨Šè™Ÿï¼ˆyfinanceï¼Œå«å¿«å–ï¼‰ |
| `GET` | `/ticker/{ticker}/moat` | è­·åŸæ²³å¥æª¢ï¼ˆæ¯›åˆ©ç‡ 5 å­£èµ°å‹¢ + YoY è¨ºæ–·ï¼‰ |
| `GET` | `/ticker/{ticker}/earnings` | å–å¾—ä¸‹æ¬¡è²¡å ±æ—¥æœŸï¼ˆå¿«å– 24 å°æ™‚ï¼‰ |
| `GET` | `/ticker/{ticker}/dividend` | å–å¾—è‚¡æ¯æ®–åˆ©ç‡èˆ‡é™¤æ¯æ—¥ |
| `GET` | `/ticker/{ticker}/scan-history` | å–å¾—å€‹è‚¡æƒææ­·å²ï¼ˆå«è¨Šè™Ÿèˆ‡æ™‚é–“ï¼‰ |
| `POST` | `/ticker/{ticker}/thesis` | æ–°å¢è§€é»ï¼ˆè‡ªå‹•ç‰ˆæ§ version +1ï¼Œå«æ¨™ç±¤ï¼‰ |
| `GET` | `/ticker/{ticker}/thesis` | å–å¾—è§€é»ç‰ˆæ§æ­·å² |
| `PATCH` | `/ticker/{ticker}/category` | åˆ‡æ›è‚¡ç¥¨åˆ†é¡ |
| `POST` | `/ticker/{ticker}/deactivate` | ç§»é™¤è¿½è¹¤ï¼ˆå«ç§»é™¤åŸå› ï¼‰ |
| `POST` | `/ticker/{ticker}/reactivate` | é‡æ–°å•Ÿç”¨å·²ç§»é™¤è‚¡ç¥¨ï¼ˆå¯æ›´æ–°åˆ†é¡èˆ‡è§€é»ï¼‰ |
| `GET` | `/ticker/{ticker}/removals` | å–å¾—ç§»é™¤æ­·å² |
| `POST` | `/ticker/{ticker}/alerts` | å»ºç«‹è‡ªè¨‚åƒ¹æ ¼è­¦å ±ï¼ˆmetric / operator / thresholdï¼‰ |
| `GET` | `/ticker/{ticker}/alerts` | å–å¾—å€‹è‚¡çš„æ‰€æœ‰åƒ¹æ ¼è­¦å ± |
| `DELETE` | `/alerts/{id}` | åˆªé™¤åƒ¹æ ¼è­¦å ± |
| `POST` | `/scan` | V2 ä¸‰å±¤æ¼æ–—æƒæï¼ˆéåŒæ­¥ï¼‰ï¼Œåƒ…æ¨æ’­å·®ç•°é€šçŸ¥ |
| `GET` | `/scan/history` | å–å¾—æœ€è¿‘æƒæç´€éŒ„ï¼ˆè·¨è‚¡ç¥¨ï¼‰ |
| `POST` | `/digest` | è§¸ç™¼æ¯é€±æŠ•è³‡çµ„åˆæ‘˜è¦ï¼ˆéåŒæ­¥ï¼‰ï¼Œçµæœé€é Telegram æ¨æ’­ |
| `GET` | `/summary` | ç´”æ–‡å­—æŠ•è³‡çµ„åˆæ‘˜è¦ï¼ˆå°ˆç‚º AI agent / chat è¨­è¨ˆï¼‰ |
| `POST` | `/webhook` | çµ±ä¸€å…¥å£ â€” ä¾› OpenClaw ç­‰ AI agent ä½¿ç”¨ |
| `GET` | `/docs` | Swagger UIï¼ˆäº’å‹•å¼ API æ–‡ä»¶ï¼‰ |
| `GET` | `/openapi.json` | OpenAPI è¦ç¯„ï¼ˆJSONï¼‰ |

### ç¯„ä¾‹ï¼šæ–°å¢è‚¡ç¥¨ï¼ˆå«æ¨™ç±¤ï¼‰

```bash
curl -X POST http://localhost:8000/ticker \
  -H "Content-Type: application/json" \
  -d '{"ticker": "NVDA", "category": "Moat", "thesis": "è³£éŸå­çµ¦å·¨é ­çš„ç‹ã€‚", "tags": ["AI", "Semiconductor"]}'
```

### ç¯„ä¾‹ï¼šæ›´æ–°è§€é»ï¼ˆå«æ¨™ç±¤ï¼‰

```bash
curl -X POST http://localhost:8000/ticker/NVDA/thesis \
  -H "Content-Type: application/json" \
  -d '{"content": "GB200 éœ€æ±‚è¶…é æœŸï¼Œä¸Šèª¿ç›®æ¨™åƒ¹ã€‚", "tags": ["AI", "Semiconductor", "Hardware"]}'
```

### ç¯„ä¾‹ï¼šè§¸ç™¼æƒæ

```bash
curl -X POST http://localhost:8000/scan
```

### ç¯„ä¾‹ï¼šå»ºç«‹åƒ¹æ ¼è­¦å ±

```bash
# ç•¶ NVDA çš„ RSI < 30 æ™‚é€šçŸ¥
curl -X POST http://localhost:8000/ticker/NVDA/alerts \
  -H "Content-Type: application/json" \
  -d '{"metric": "rsi", "operator": "lt", "threshold": 30}'
```

### ç¯„ä¾‹ï¼šé‡æ–°å•Ÿç”¨å·²ç§»é™¤è‚¡ç¥¨

```bash
curl -X POST http://localhost:8000/ticker/ZM/reactivate \
  -H "Content-Type: application/json" \
  -d '{"category": "Growth", "thesis": "é‡æ–°è§€å¯Ÿä¸²æµé€šè¨Šå•†æ©Ÿã€‚"}'
```

### ç¯„ä¾‹ï¼šæ‰¹æ¬¡åŒ¯å…¥è‚¡ç¥¨

```bash
curl -X POST http://localhost:8000/stocks/import \
  -H "Content-Type: application/json" \
  -d '[{"ticker":"AAPL","category":"Moat","thesis":"å“ç‰Œè­·åŸæ²³","tags":["Hardware"]}]'
```

## OpenClaw æ•´åˆ

[OpenClaw](https://docs.openclaw.ai/) æ˜¯ä¸€å€‹é–‹æº AI agent gatewayï¼Œè®“ä½ å¯ä»¥é€é WhatsAppã€Telegramã€Discord ç­‰å³æ™‚é€šè¨Šå·¥å…·èˆ‡ Azusa Radar äº’å‹•ã€‚

### å‰ç½®éœ€æ±‚

```bash
npm install -g openclaw@latest
openclaw onboard
```

ç¢ºä¿ OpenClaw Gateway æ­£åœ¨é‹è¡Œï¼Œä¸” Azusa Radar çš„ Docker Compose æœå‹™å·²å•Ÿå‹•ã€‚

### è¨­å®šæ–¹å¼

**æ–¹å¼ä¸€ï¼šä½¿ç”¨ Skill æª”æ¡ˆ**

å°‡ `scripts/openclaw/azusa-radar/` è³‡æ–™å¤¾è¤‡è£½åˆ° OpenClaw skills ç›®éŒ„ï¼š

```bash
cp -r scripts/openclaw/azusa-radar/ ~/.openclaw/skills/azusa-radar/
```

**æ–¹å¼äºŒï¼šä½¿ç”¨ AGENTS.md**

å°‡ `scripts/openclaw/AGENTS.md` è¤‡è£½åˆ° OpenClaw workspaceï¼š

```bash
cp scripts/openclaw/AGENTS.md ~/.openclaw/workspace/AGENTS.md
```

### Agent-Friendly Endpoints

| Endpoint | ç”¨é€” |
|----------|------|
| `GET /summary` | ç´”æ–‡å­—æŠ•è³‡çµ„åˆæ‘˜è¦ï¼Œé©åˆ chat å›è¦† |
| `POST /webhook` | çµ±ä¸€å…¥å£ï¼Œæ¥å— `{"action": "...", "ticker": "...", "params": {}}` |
| `GET /openapi.json` | è‡ªå‹•ç”Ÿæˆçš„ OpenAPI è¦ç¯„ |
| `GET /docs` | Swagger UI äº’å‹•å¼æ–‡ä»¶ |

### Webhook Actions

| Action | èªªæ˜ | éœ€è¦ ticker |
|--------|------|:-----------:|
| `summary` | æŠ•è³‡çµ„åˆå¥åº·æ‘˜è¦ | å¦ |
| `signals` | å–®ä¸€è‚¡ç¥¨æŠ€è¡“æŒ‡æ¨™ | æ˜¯ |
| `scan` | è§¸ç™¼å…¨åŸŸæƒæ | å¦ |
| `moat` | è­·åŸæ²³åˆ†æ | æ˜¯ |
| `alerts` | æŸ¥çœ‹åƒ¹æ ¼è­¦å ± | æ˜¯ |
| `add_stock` | æ–°å¢è‚¡ç¥¨ | æ˜¯ï¼ˆåœ¨ params ä¸­ï¼‰ |

### ç¯„ä¾‹å°è©±ï¼ˆé€é WhatsApp/Telegram/Discordï¼‰

| ä½ èªª... | Agent åŸ·è¡Œ... |
|---------|---------------|
| ã€Œç›®å‰æŠ•è³‡çµ„åˆç‹€æ³å¦‚ä½•ã€ | `curl http://localhost:8000/summary` |
| ã€Œå¹«æˆ‘æŸ¥ NVDA çš„æŠ€è¡“æŒ‡æ¨™ã€ | `POST /webhook {"action":"signals","ticker":"NVDA"}` |
| ã€ŒåŸ·è¡Œä¸€æ¬¡å…¨åŸŸæƒæã€ | `POST /webhook {"action":"scan"}` |
| ã€Œæ–°å¢ AMD åˆ°è­·åŸæ²³åˆ†é¡ã€ | `POST /webhook {"action":"add_stock","params":{"ticker":"AMD","category":"Moat","thesis":"..."}}` |

### ç›¸é—œé€£çµ

- [OpenClaw æ–‡ä»¶](https://docs.openclaw.ai/)
- [Skills è¨­å®š](https://docs.openclaw.ai/tools/skills)
- [Tools è¨­å®š](https://docs.openclaw.ai/tools)
- [Cron Jobs](https://docs.openclaw.ai/automation/cron-jobs)

---

## å°ˆæ¡ˆçµæ§‹ï¼ˆClean Architectureï¼‰

å¾Œç«¯æ¡ç”¨ Clean Architecture å››å±¤æ¶æ§‹ï¼Œä¾è³´æ–¹å‘ç”±å¤–å‘å…§ï¼Œå„å±¤è·è²¬æ˜ç¢ºï¼š

```mermaid
graph TB
  subgraph layers [Backend æ¶æ§‹]
    API["api/ â€” è–„æ§åˆ¶å™¨"]
    APP["application/ â€” æœå‹™ç·¨æ’"]
    DOMAIN["domain/ â€” ç´”æ¥­å‹™é‚è¼¯"]
    INFRA["infrastructure/ â€” å¤–éƒ¨é©é…å™¨"]
  end
  API --> APP
  APP --> DOMAIN
  APP --> INFRA
  INFRA --> DOMAIN
```

```
azusa-stock/
â”œâ”€â”€ .env                              # Telegram Bot æ†‘è­‰
â”œâ”€â”€ .env.example                      # ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
â”œâ”€â”€ .dockerignore                     # Docker build æ’é™¤æ¸…å–®
â”œâ”€â”€ .gitignore
â”œâ”€â”€ .cursorrules                      # Cursor AI æ¶æ§‹å¸«æŒ‡å¼•
â”œâ”€â”€ docker-compose.yml                # Backend + Frontend + Scanner æœå‹™å®šç¾©
â”œâ”€â”€ README.md
â”‚
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ main.py                       # é€²å…¥é»ï¼šå»ºç«‹ Appã€è¨»å†Šè·¯ç”±
â”‚   â”œâ”€â”€ logging_config.py             # é›†ä¸­å¼æ—¥èªŒï¼ˆè·¨å±¤å…±ç”¨ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ domain/                       # é ˜åŸŸå±¤ï¼šç´”æ¥­å‹™é‚è¼¯ï¼Œç„¡æ¡†æ¶ä¾è³´
â”‚   â”‚   â”œâ”€â”€ constants.py              #   é›†ä¸­ç®¡ç†é–¾å€¼ã€å¿«å–è¨­å®šã€å…±ç”¨è¨Šæ¯
â”‚   â”‚   â”œâ”€â”€ enums.py                  #   åˆ†é¡ã€ç‹€æ…‹åˆ—èˆ‰ + å¸¸æ•¸
â”‚   â”‚   â”œâ”€â”€ entities.py               #   SQLModel è³‡æ–™è¡¨ (Stock, ThesisLog, RemovalLog, ScanLog, PriceAlert)
â”‚   â”‚   â””â”€â”€ analysis.py               #   ç´”è¨ˆç®—ï¼šRSI, Bias, æ±ºç­–å¼•æ“ï¼ˆå¯ç¨ç«‹æ¸¬è©¦ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ application/                  # æ‡‰ç”¨å±¤ï¼šUse Case ç·¨æ’
â”‚   â”‚   â””â”€â”€ services.py               #   Stock / Thesis / Scan / Portfolio Summary æœå‹™
â”‚   â”‚
â”‚   â”œâ”€â”€ infrastructure/               # åŸºç¤è¨­æ–½å±¤ï¼šå¤–éƒ¨é©é…å™¨
â”‚   â”‚   â”œâ”€â”€ database.py               #   SQLite engine + session ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ repositories.py           #   Repository Patternï¼ˆé›†ä¸­ DB æŸ¥è©¢ï¼Œå«æ‰¹æ¬¡æ“ä½œï¼‰
â”‚   â”‚   â”œâ”€â”€ market_data.py            #   yfinance é©é…å™¨ï¼ˆå«å¿«å– + Rate Limiterï¼‰
â”‚   â”‚   â””â”€â”€ notification.py           #   Telegram Bot é©é…å™¨
â”‚   â”‚
â”‚   â””â”€â”€ api/                          # API å±¤ï¼šè–„æ§åˆ¶å™¨
â”‚       â”œâ”€â”€ schemas.py                #   Pydantic è«‹æ±‚/å›æ‡‰ Schemaï¼ˆå« Webhookï¼‰
â”‚       â”œâ”€â”€ stock_routes.py           #   è‚¡ç¥¨ç®¡ç† + /summary + /webhook è·¯ç”±
â”‚       â”œâ”€â”€ thesis_routes.py          #   è§€é»ç‰ˆæ§è·¯ç”±
â”‚       â””â”€â”€ scan_routes.py            #   ä¸‰å±¤æ¼æ–—æƒæ + æ¯é€±æ‘˜è¦è·¯ç”±ï¼ˆå« mutexï¼‰
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ config.py                     # å‰ç«¯é›†ä¸­å¸¸æ•¸èˆ‡è¨­å®š
â”‚   â””â”€â”€ app.py                        # Dashboardï¼šå››åˆ†é  + å°å­˜ + è§€é»ç·¨è¼¯å™¨
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ import_stocks.py              # å¾ JSON åŒ¯å…¥è‚¡ç¥¨è‡³ APIï¼ˆæ”¯æ´ upsertï¼‰
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â””â”€â”€ azusa_watchlist.json      # é è¨­è§€å¯Ÿåå–®
â”‚   â””â”€â”€ openclaw/
â”‚       â”œâ”€â”€ AGENTS.md                 # OpenClaw workspace æŒ‡ä»¤ç¯„æœ¬
â”‚       â””â”€â”€ azusa-radar/
â”‚           â””â”€â”€ SKILL.md              # OpenClaw Skill å®šç¾©æª”
â”‚
â””â”€â”€ logs/                             # æ—¥èªŒæª”æ¡ˆï¼ˆbind-mount è‡ªå‹•ç”¢ç”Ÿï¼‰
    â”œâ”€â”€ radar.log                     # ç•¶æ—¥æ—¥èªŒ
    â””â”€â”€ radar.log.YYYY-MM-DD         # æ­·å²æ—¥èªŒï¼ˆä¿ç•™ 3 å¤©ï¼‰
```

**å„å±¤è·è²¬ï¼š**

| å±¤ | ç›®éŒ„ | è·è²¬ | ä¾è³´ |
|----|------|------|------|
| **Domain** | `domain/` | ç´”æ¥­å‹™è¦å‰‡ã€è¨ˆç®—ã€åˆ—èˆ‰ã€‚ä¸ä¾è³´æ¡†æ¶ï¼Œå¯ç¨ç«‹å–®å…ƒæ¸¬è©¦ã€‚ | ç„¡ |
| **Application** | `application/` | Use Case ç·¨æ’ï¼šå”èª¿ Repository èˆ‡ Adapter å®Œæˆæ¥­å‹™æµç¨‹ã€‚ | Domain, Infrastructure |
| **Infrastructure** | `infrastructure/` | å¤–éƒ¨é©é…å™¨ï¼šDBã€yfinanceã€Telegramã€‚å¯æ›¿æ›ä¸å½±éŸ¿æ¥­å‹™ã€‚ | Domain |
| **API** | `api/` | è–„æ§åˆ¶å™¨ï¼šè§£æ HTTP è«‹æ±‚ â†’ å‘¼å« Service â†’ å›å‚³å›æ‡‰ã€‚ | Application |

## æ—¥èªŒç®¡ç†

æ—¥èªŒæª”æ¡ˆé€é bind-mount æ˜ å°„è‡³å°ˆæ¡ˆæ ¹ç›®éŒ„çš„ `logs/` è³‡æ–™å¤¾ï¼Œå¯ç›´æ¥åœ¨æœ¬æ©Ÿå­˜å–ã€‚

```bash
# å³æ™‚è¿½è¹¤æ—¥èªŒ
tail -f logs/radar.log

# æˆ–ç›´æ¥åœ¨ Cursor / VS Code ä¸­é–‹å•Ÿ logs/radar.log
```

**è¼ªæ›¿è¦å‰‡ï¼š**
- æ¯æ—¥ UTC åˆå¤œè‡ªå‹•è¼ªæ›¿
- ä¿ç•™æœ€è¿‘ 3 å¤©çš„æ­·å²æ—¥èªŒï¼Œè¶…éè‡ªå‹•åˆªé™¤
- æ ¼å¼ï¼š`2026-02-09 14:30:00 | INFO     | main | è‚¡ç¥¨ TSLA å·²æˆåŠŸæ–°å¢è‡³è¿½è¹¤æ¸…å–®ã€‚`

**ç’°å¢ƒè®Šæ•¸èª¿æ•´ï¼š**
- `LOG_LEVEL` â€” æ—¥èªŒç­‰ç´šï¼Œé è¨­ `INFO`ï¼ˆå¯è¨­ç‚º `DEBUG` å–å¾—æ›´è©³ç´°è³‡è¨Šï¼‰
- `LOG_DIR` â€” æ—¥èªŒç›®éŒ„ï¼Œé è¨­ `/app/data/logs`

## è³‡æ–™æª”æ¡ˆæ ¼å¼

åŒ¯å…¥ç”¨çš„ JSON æª”æ¡ˆæ ¼å¼ï¼ˆ`azusa_watchlist.json`ï¼‰ï¼š

```json
[
  {
    "ticker": "NVDA",
    "category": "Moat",
    "thesis": "ä½ å°é€™æª”è‚¡ç¥¨çš„è§€é»ã€‚",
    "tags": ["AI", "Semiconductor"]
  }
]
```

- `ticker` â€” è‚¡ç¥¨ä»£è™Ÿï¼ˆç¾è‚¡ï¼‰
- `category` â€” åˆ†é¡ï¼Œå¿…é ˆæ˜¯ `Trend_Setter`ã€`Moat`ã€`Growth`ã€`ETF` ä¹‹ä¸€
- `thesis` â€” åˆå§‹è§€é»
- `tags` â€” é ˜åŸŸæ¨™ç±¤ï¼ˆé¸å¡«ï¼Œé è¨­ç‚ºç©ºé™£åˆ—ï¼‰
