# Pre-commit hooks for Folio — enforces architecture boundaries and code style at commit time.
#
# Setup (done automatically by `make setup`):
#   pip install pre-commit
#   pre-commit install
#
# Run manually:
#   pre-commit run --all-files
#
# Skip (emergency only — CI will still catch violations):
#   git commit --no-verify

repos:
  - repo: local
    hooks:
      - id: architecture-boundary
        name: architecture boundary check
        entry: bash -c 'cd backend && LOG_DIR=/tmp/folio_test_logs DATABASE_URL=sqlite:// .venv/bin/python -m pytest tests/test_architecture.py -q --tb=short --no-header'
        language: system
        pass_filenames: false
        files: ^backend/

      - id: ruff-check
        name: ruff lint
        entry: bash -c 'backend/.venv/bin/ruff check backend/'
        language: system
        pass_filenames: false
        files: ^backend/.*\.py$

      - id: ruff-format
        name: ruff format check
        entry: bash -c 'backend/.venv/bin/ruff format --check backend/'
        language: system
        pass_filenames: false
        files: ^backend/.*\.py$
