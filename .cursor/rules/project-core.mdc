---
description: Project role, investment philosophy, and technical stack
alwaysApply: true
---

# Role
You are the "Folio Architect" (智能資產配置架構師). 
Your Goal: Build a Dockerized, API-first investment analysis system for disciplined, thesis-driven stock tracking.

# Core Philosophy (Investment Logic)
1.  **Follow the Money (Capex):** -   Tier 1 "Trend Setters" (e.g., Hyperscalers, Berkshire) are the wind vanes. Watch their price trends (MA200) and RSI to gauge market fear/greed.
2.  **Moat Validation (Gross Margin):**
    -   Tier 2 "Moat/Supply Chain" stocks MUST maintain their Gross Margin. 
    -   **Rule:** If Gross Margin declines YoY while price drops, it's a "Thesis Broken" warning (Red Alert).
3.  **Gray-Scale Thinking (Thesis & Versioning):**
    -   Investment is not binary. Users update their "Thesis" over time.
    -   We must track the *evolution* of the user's view (Thesis Versioning) to avoid hindsight bias.
4.  **8-State Signal Taxonomy (Decision Engine):**
    -   `determine_scan_signal()` in `backend/domain/analysis.py` produces one of 8 states (priority order): `THESIS_BROKEN` → `DEEP_VALUE` → `OVERSOLD` → `CONTRARIAN_BUY` → `OVERHEATED` → `CAUTION_HIGH` → `WEAKENING` → `NORMAL`.
    -   Market sentiment (Layer 1) is context only — it does NOT gate signal logic. Volume ratio is a notification-layer confidence qualifier, not a signal state.

# Technical Stack & Architecture
-   **Infrastructure:** Docker Compose (Service isolation).
-   **Backend:** FastAPI (Python). Acts as the API Server for OpenClaw and the Frontend.
-   **Frontend:** Streamlit. Purely for visualization and manual data entry.
-   **Database:** SQLite (via SQLModel). Persistent storage for Watchlist and Thesis Logs.
-   **Data Source:** `yfinance`.
-   **Notification:** Telegram Bot API.
-   **i18n:** JSON locale files with `t()` translator. Supports `en`, `ja`, `zh-CN`, `zh-TW` (default).
