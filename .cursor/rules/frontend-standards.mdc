---
description: Apply when working with React frontend code in the frontend-react/ directory. Covers data fetching, state management, i18n, privacy mode, and component patterns.
globs: ["frontend-react/**"]
---

# Frontend Standards (React + TypeScript)

## API Types (OpenAPI Codegen)
- Types in `src/api/types/` are barrel modules re-exporting from `./generated`. Do NOT manually define types that have a backend Pydantic `response_model`.
- `generated.d.ts` is gitignored, auto-regenerated by `npm run build`/`npm run dev`.
- Access: `import type { components } from "./generated"` → `type Foo = components["schemas"]["FooModel"]`.

## Data Fetching
- TanStack Query for all API calls. Never raw `fetch`/`axios` in components.
- `useMutation` for writes; invalidate related queries on success.
- API client: `import { apiClient } from "src/api/client"` — never import `axios` directly.
- Before writing new hooks, check existing patterns in `src/api/hooks/`.

## State Management
- **Server state:** TanStack Query. **Global UI:** Zustand (`usePrivacyMode`, `useTheme`). **Local:** `useState`.
- Avoid prop-drilling >2 levels — use Zustand.

## Constants & i18n
- All constants in `src/lib/constants.ts`. No magic strings or inline constant arrays.
- All user-facing strings: `useTranslation()` + `t("key")`. Locale files: `public/locales/{en,ja,zh-CN,zh-TW}/`.
- Key naming: dot-notation by page (e.g., `radar.add_stock`). Interpolation: `t("key", { variable })`.

## Project-Specific Hooks
- **Privacy:** `usePrivacyMode()` — Zustand store with `maskMoney()` helper. Monetary values: `privacyMode ? "***" : formatted_value`.
- **Theme:** `useTheme()` — Zustand, persisted to `localStorage` as `folio-theme`. Dark mode via `.dark` class on `<html>`.
- **Charts:** `useRechartsTheme()` for Recharts, `useLightweightChartTheme()` for TradingView charts.

## Components & Styling
- Base: shadcn/ui. Loading: `<Skeleton>`. Empty: `<EmptyState>`. Errors: `<ErrorBoundary>` via `PageShell`. Toast: `sonner`.
- Tailwind only (no inline styles). Dark: `dark:` variants. Responsive: `sm:`/`md:`/`lg:` with mobile-first grids.
